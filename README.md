# Silwa Tower LV Panel - Estimation Dashboard

## Overview
This dashboard displays the estimation data for Silwa Tower LV Panel project from Technoplus Dubai's Energy Department.

## Files Structure

### Dashboard
- `dashboard.html` - Main estimation dashboard page
- `dashboard.css` - Dashboard-specific styles
- `dashboard.js` - Dashboard JavaScript for data visualization
- `styles.css` - Base stylesheet (shared styles)
- `script.js` - JavaScript for navigation and interactivity

### Data Extraction Scripts
- `extract_mdb_data.py` - Extracts 4 main MDBs (MDB1, MDB2, MDB3, MDB4) from e2.xlsx
- `extract_all_boards.py` - Extracts all boards from TOTALLIST sheet
- `extract_board_details.py` - Extracts detailed data from individual board sheets
- `generate_all_board_details.py` - Generates JSON files for all board details (for static hosting)
- `update_estimates.py` - Updates estimates in TOTALLIST sheet from individual board sheets
- `board_details_api.py` - HTTP server to serve board details API
- `server.py` - Flask server for serving dashboard and API endpoints

### Data Files
- `e2.xlsx` - Source Excel file with TOTALLIST sheet
- `mdb_data.json` - JSON file with 4 main MDB data (generated by extract scripts)
- `all_boards_data.json` - JSON file with all boards data (generated by extract_all_boards.py)
- `board_details/` - Directory containing JSON files for each board's detailed information (generated by generate_all_board_details.py)

## Dashboard Features

### Main MDB Summary
- Displays 4 main MDBs at the top:
  - MDB1
  - MDB2
  - MDB3
  - MDB.GF.04
- Shows individual estimates and percentages
- Total estimate for all 4 MDBs

### All Boards Table
- Complete list of all boards from TOTALLIST sheet
- Search functionality
- Sort by name or estimate
- Board type classification (MDB, SMDB, EMDB, ESMDB)

## How to Update Dashboard Data

### Step 1: Update Excel File
1. Make changes to `e2.xlsx` file
2. Update the TOTALLIST sheet with new board data
3. Run `update_estimates.py` to update estimates from individual sheets:
   ```bash
   python3 update_estimates.py
   ```

### Step 2: Extract Data for Dashboard
Run the extraction script to generate JSON files:
```bash
python3 extract_all_boards.py
```

This will:
- Extract 4 main MDBs and save to `mdb_data.json`
- Extract all boards and save to `all_boards_data.json`

### Step 3: Refresh Dashboard
Open `dashboard.html` in a browser to see updated data.

## Requirements

### Python Packages
```bash
pip install openpyxl
```

### Browser
- Modern browser with JavaScript enabled
- No server required - works as static files

## Usage

### Viewing Dashboard

**Option 1: With Local Server (Recommended for Development)**
```bash
# Start the Flask server
python3 server.py 8000

# Then access dashboard at:
# http://localhost:8000/dashboard.html
```

**Option 2: Static Hosting (For Online Deployment)**
- The dashboard works online without a server
- Board details are loaded from pre-generated JSON files in `board_details/` directory
- To update board details, run:
  ```bash
  python3 generate_all_board_details.py
  ```
- Then commit and push the `board_details/` directory to your repository

**Option 3: Direct File Access**
- Open `dashboard.html` directly in a browser
- Board details will be loaded from JSON files if available

### Viewing Board Details

1. Click on any board row in the dashboard
2. A detail modal will open showing:
   - Summary information (Net Total, No. of Units)
   - Complete item list from the board's Excel sheet
3. Close the modal by:
   - Clicking the Ã— button
   - Clicking outside the modal (on overlay)
   - Pressing Escape key
   - Using browser back button

### Updating Data

1. **Update Excel File**: Make changes to `e2.xlsx`
2. **Extract Data**: Run extraction scripts:
   ```bash
   python3 extract_all_boards.py
   python3 generate_embedded_data.py
   python3 generate_all_board_details.py  # Generate board details JSON files
   ```
3. **Restart Server**: If using the Flask server, restart it to load new data
4. **Commit Changes**: For online deployment, commit the updated JSON files:
   ```bash
   git add board_details/ all_boards_data.json embed_data.js
   git commit -m "Update board data"
   git push
   ```

## Dashboard Features

### Filter Options
- **All**: View all 4 MDB sections
- **MDB1, MDB2, MDB3, MDB4**: View specific MDB section only

### MDB Sections
Each MDB section displays:
- MDB statistics (Estimate, Load, Items, Board Count)
- Table of all boards under that MDB
- Clickable board rows to view detailed information

### Board Details
- Click any board row to view detailed information
- Details are loaded from:
  - API endpoint (when running Flask server locally)
  - Pre-generated JSON files (when deployed online or using static files)
- Shows summary (Net Total, No. of Units) and complete item list
- Filters out rows with zero/null AMOUNT values
- Highlights summary rows (TOTAL to NET TOTAL)
- Modal automatically closes when navigating back
- Currency formatted as AED with 2 decimal places
- Price columns show numbers with 2 decimals (no AED prefix)

## Notes

- The dashboard reads data from JSON files (`mdb_data.json` and `all_boards_data.json`)
- JSON files must be regenerated after updating `e2.xlsx`
- All currency values are in AED (UAE Dirhams)
- The dashboard is responsive and works on mobile devices


