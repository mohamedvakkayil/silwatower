# Silwa Tower LV Panel - Estimation Dashboard

## Overview
This dashboard displays the estimation data for Silwa Tower LV Panel project from Technoplus Dubai's Energy Department.

## Files Structure

### Dashboard
- `dashboard.html` - Main estimation dashboard page
- `dashboard.css` - Dashboard-specific styles
- `dashboard.js` - Dashboard JavaScript for data visualization
- `styles.css` - Base stylesheet (shared styles)
- `script.js` - JavaScript for navigation and interactivity

### Data Extraction Scripts
- `extract_mdb_data.py` - Extracts 4 main MDBs (MDB1, MDB2, MDB3, MDB4) from e2.xlsx
- `extract_all_boards.py` - Extracts all boards from TOTALLIST sheet
- `extract_board_details.py` - Extracts detailed data from individual board sheets
- `update_estimates.py` - Updates estimates in TOTALLIST sheet from individual board sheets
- `board_details_api.py` - HTTP server to serve board details API

### Data Files
- `e2.xlsx` - Source Excel file with TOTALLIST sheet
- `mdb_data.json` - JSON file with 4 main MDB data (generated by extract scripts)
- `all_boards_data.json` - JSON file with all boards data (generated by extract_all_boards.py)

## Dashboard Features

### Main MDB Summary
- Displays 4 main MDBs at the top:
  - MDB1
  - MDB2
  - MDB3
  - MDB.GF.04
- Shows individual estimates and percentages
- Total estimate for all 4 MDBs

### All Boards Table
- Complete list of all boards from TOTALLIST sheet
- Search functionality
- Sort by name or estimate
- Board type classification (MDB, SMDB, EMDB, ESMDB)

## How to Update Dashboard Data

### Step 1: Update Excel File
1. Make changes to `e2.xlsx` file
2. Update the TOTALLIST sheet with new board data
3. Run `update_estimates.py` to update estimates from individual sheets:
   ```bash
   python3 update_estimates.py
   ```

### Step 2: Extract Data for Dashboard
Run the extraction script to generate JSON files:
```bash
python3 extract_all_boards.py
```

This will:
- Extract 4 main MDBs and save to `mdb_data.json`
- Extract all boards and save to `all_boards_data.json`

### Step 3: Refresh Dashboard
Open `dashboard.html` in a browser to see updated data.

## Requirements

### Python Packages
```bash
pip install openpyxl
```

### Browser
- Modern browser with JavaScript enabled
- No server required - works as static files

## Usage

### Viewing Dashboard

**Option 1: With Local Server (Recommended for Board Details)**
```bash
# Start the board details API server
python3 board_details_api.py

# Then access dashboard at:
# http://localhost:8000/dashboard.html
```

**Option 2: Direct File Access**
- Open `dashboard.html` directly in a browser
- Note: Board detail views require a server to fetch data from Excel sheets

### Viewing Board Details

1. Click on any board row in the dashboard
2. A detail modal will open showing:
   - Summary information (Net Total, No. of Units)
   - Complete item list from the board's Excel sheet
3. Close the modal by:
   - Clicking the Ã— button
   - Clicking outside the modal (on overlay)
   - Pressing Escape key
   - Using browser back button

### Updating Data

1. **Update Excel File**: Make changes to `e2.xlsx`
2. **Extract Data**: Run extraction scripts:
   ```bash
   python3 extract_all_boards.py
   python3 generate_embedded_data.py
   ```
3. **Restart Server**: If using the API server, restart it to load new data

## Dashboard Features

### Filter Options
- **All**: View all 4 MDB sections
- **MDB1, MDB2, MDB3, MDB4**: View specific MDB section only

### MDB Sections
Each MDB section displays:
- MDB statistics (Estimate, Load, Items, Board Count)
- Table of all boards under that MDB
- Clickable board rows to view detailed information

### Board Details
- Click any board row to view detailed information
- Details are extracted from the corresponding Excel sheet
- Shows summary (Net Total, No. of Units) and complete item list
- Modal automatically closes when navigating back

## Notes

- The dashboard reads data from JSON files (`mdb_data.json` and `all_boards_data.json`)
- JSON files must be regenerated after updating `e2.xlsx`
- All currency values are in AED (UAE Dirhams)
- The dashboard is responsive and works on mobile devices


